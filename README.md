<h1>SOAR EDR Project | Intro</h1>

<p align="center">
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<h2>Description</h2>
<br />
<p align="center">
Welcome to part four of five for the series on the SOAR EDR project. If you haven't seen the previous parts where we go over how to build out a workflow for this project, set up LimaCharlie, and create our detection rule, I highly recommend you go and see that first.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  Today our objective is to set up both Slack and Tines. Then, test our connection between LimaCharlie and Tines to make sure that our SOAR is seeing the detection generated by LimaCharlie. Let's get started.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  To begin you want to head over to Slack.com. Then, click on "Get Started Free" button. Go ahead and create an account. Do make sure that you use a valid email account, because they will be sending you a confirmation code.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  Once you enter that in, go ahead and select "Create a Workspace". For the workspace name I'll call it as "MyDFIR-SOAR-EDR". Click on "Next", and my name is going to be  "demo".
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  I'll go ahead and skip this step. "What's your team working on right now?" I'll type "The best project", then click "Next". Start with free and now we're set up with Slack. There's one thing I want to do though, its to add a new channel.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  So I'll click "Add Channels", then "Create a new channel". I'll call this as "alerts" and I'll put this as public. I'll skip adding people, and on our left-hand side we have a new channel called "alerts".
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  So what this will do is when we receive a detection from LimaCharlie on Tines; Tines will then send a message over to slack. Specifically within the "alert" channel because as a SOC analyst you would probably want to have different channels and you'll want to have a dedicated channel for your alerts, so that is why we created an alerts channel.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  So now let's head over to Tines.com and click on "Sign up now" from the signup. You can sign up with Google or Microsoft, but just like Slack do make sure you have a valid email account because they will send you a confirmation email. Once you sign in, you'll see the screen right here.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  Now we can go ahead and begin with an example, but I'll go ahead and select the "X" to exit out. I'll click on "End Tour". If we take a look on the left-hand side, these are some of the actions that we can use to build our story, AKA Playbook. So for example, we can use a webhook and we can use an HTTP request.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  All we need to do is just drag it into the storyboard. I'll delete everything, except email and weather. There's also some templates so we can click on "Templates", and these are just pre-built templates to use. So for example, we have VirusTotal.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  We have some options here. We can search up "hash" and click on "Get File Behaviour in VirusTotal". So if I click on that, there's a value entry for the file hash, but we don't need this right now. I'll go ahead and delete that.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  So there are file hashes and also story libraries, so if you want to start with a template, we can do that as well. For example, if we wanted to add a domain to a block list in Zscaler, we can go ahead and click on that. Here's our pre-built story.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  We just simply have to import it and it will be imported into our Playbook or story, so that's very helpful. There's also tools, a page group, and Notes. If you want to head over to the dashboard, we can click on the Tines icon on the top left corner, so let's go ahead and click on that.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  What I'm going to do is click on my name and select dark mode because this is just a lot easier for me on my eyes. Now that I changed it to dark mode, let's go back to our story. What we need to do is establish the link between LimaCharlie and Tines so that way we can know that Tines is retrieving the detection.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  So how do we do that? Let's go ahead and click on the simple weather app and I'll go ahead and delete that. For the send email, I'll just delete that as well. So basically start from scratch, and what I'll be using is a webhook. So let's go ahead and grab that.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  I'll name the webhook action "Retrieve Detections". For the description, I'll just say "Retrieves LimaCharlie Detections". For the webhook URL, I'll go ahead and just copy that. Now let's head over to LimaCharlie. So I'll select my organization and where we want to go is "Outputs".
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  I'll click on "Add Output" and we got a couple of options here. We have "Events", "Detections", "Deployments", "Auto Logs", "Artifacts", and "Tailored". What we're interested in the most is "Detections", this is a stream of detections reported by the rule engine. That's what we want, so I'll click on "Select".
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  Now we have our "Destination". So we have "Amazon S3", "Apache", "Azure", "Data Dog", and "Elastic". So I'll go ahead and select "Tines". Now let's say we didn't have Tines, we can also just select Webhook as well. Since we do have an application for Tines, let's just select that.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  For the name, let's put in "MyDFIR-SOAR-EDR". For the destination host, let's paste it into the web hook. Then, click "Save Output". Now we got our configuration saved, but we couldn't detect any recent samples moving through this output. I'll hit refresh, refresh again and there's still nothing.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  So what that means is that we just need to regenerate our event. So over on our server, I'll type ".\LaZagne.exe" and hit enter. This should in theory generate our detection. So I'll click on refresh and here we go.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  We have our "MyDFIR - HackTool - LaZagne", and the rest of this looks pretty good. Let's head over to our Tines and our "Retrieve Detections" to select "Events". I'll move this up just a bit and let's take a look at our most recent detection which is the first one here.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  So I'll expand that body and look at that. That's pretty cool. Now we have our detection exactly one-to-one. So we have our title which is "MyDFIR - HackTool - Lazage" and if we open up the detect event, we have the command line, the file path, the hash, and the username.
<br />
<br />
<img src="" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br />
<br />
  Now we can start building our Playbook to finally perform some automation. We should now have accounts for Slack, Tines, and LimaCharlie. We can also confirm that the detection is showing up in Times. This means that we can begin creating our Playbook and perform some automation.
  
In the next part of our series which will be the last episode, we'll begin creating our Playbook by following the workflow that we created in part one. Do think about carving some time as it will be a longer part. That is it and thank you for reading. I hope that you're enjoying this project series. Remember to stay curious and do things differently.
